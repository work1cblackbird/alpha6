
#Область ОписаниеПеременных

Перем ДатаНачала Экспорт; // дата начала
Перем ДатаКонца Экспорт;  // дата конца
Перем Сотрудник Экспорт;  // ссылка на сотрудника

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Получить базовую сумму
Функция БазоваяСумма() Экспорт
	БазоваяСумма=0;
	
	Если ЗначениеЗаполнено(Сотрудник) Тогда
		ТекстЗапроса =" 
			|ВЫБРАТЬ
			|	ЕСТЬNULL(СУММА(ВыработкаСотрудниковОбороты.СуммаУпрОборот),0) КАК БазоваяСумма
			|ИЗ
			|	РегистрНакопления.ВыработкаСотрудников.Обороты(&ДатаНачала, &ДатаКонца, Регистратор, ) КАК ВыработкаСотрудниковОбороты
			|ГДЕ
			|	ВыработкаСотрудниковОбороты.Сотрудник = &Сотрудник";
		Запрос = Новый Запрос();
		Запрос.Текст = ТекстЗапроса;
		Запрос.УстановитьПараметр("ДатаНачала", Новый Граница(НачалоДня(ДатаНачала),ВидГраницы.Включая));
		Запрос.УстановитьПараметр("ДатаКонца", Новый Граница(КонецДня(ДатаКонца),ВидГраницы.Включая));
		Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
		// выполняем запрос
		Выборка = Запрос.Выполнить().Выбрать();
		Если Выборка.Следующий() Тогда
			БазоваяСумма=Выборка.БазоваяСумма;
		КонецЕсли; 
	КонецЕсли; 
	
	Возврат БазоваяСумма;
КонецФункции

#КонецОбласти