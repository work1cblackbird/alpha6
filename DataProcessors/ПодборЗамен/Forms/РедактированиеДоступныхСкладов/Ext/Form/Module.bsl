
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;
	
	ЗаполнитьСклады();
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура УстановитьДоступныеСклады(Команда)
	
	Закрыть(ВыгрузитьСклады());
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Функция ВыгрузитьСклады()
	
	СкладыВрем = Новый Массив;
	
	Для Каждого Строка Из Склады Цикл
		
		Если ЗначениеЗаполнено(Строка.Склад) Тогда
			СкладыВрем.Добавить(Строка.Склад);	
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат Новый ФиксированныйМассив(СкладыВрем);
	
КонецФункции

&НаСервере
Процедура ЗаполнитьСклады()
	
	Склады.Очистить();
	НовыйСписок = Новый ФиксированныйМассив(Новый Массив);
	ДоступныеСклады = ?(Параметры.ДоступныеСклады <> Неопределено, Параметры.ДоступныеСклады, НовыйСписок);
	
	Для Каждого Склад Из ДоступныеСклады Цикл
		
		Склады.Добавить().Склад = Склад;
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти
