// Модуль менеджера обработки "Печать ячеек"

#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

// Добавление ячейки
Процедура ДобавитьЯчейку(Макет, Таб, СтрТаблицаЯчеек, Столбик, Ряд);
	
	Столбик = ?(Столбик = 2, 0 , Столбик+1);
	Ряд     = ?(Столбик = 2, Ряд + 1, Ряд);

	Если Ряд >2 Тогда
		Таб.ВывестиГоризонтальныйРазделительСтраниц();
		Ряд = 0;
	КонецЕсли;
	
	Область = Макет.ПолучитьОбласть("Строка|Колонка");
	Область.Параметры.Ячейка = СокрЛП(СтрТаблицаЯчеек.Ячейка.Код);
	
 	Если Столбик = 0 Тогда
 		Таб.Вывести(Область);
 	Иначе
 		Таб.Присоединить(Область);
	КонецЕсли;
	
КонецПроцедуры // ДобавитьЯчейку()

// сформировать печатную форму
Процедура Сформировать(Объект, Таб = Неопределено, Таблица = Неопределено)
	
	Если Таблица = Неопределено Тогда
		Таблица = Объект.ТаблицаЯчеек;
	КонецЕсли;
	
	ОбщееКоличество = Таблица.Количество();
	
	Если ОбщееКоличество = 0 Тогда
		ОбщегоНазначения.СообщитьПользователю(НСтр("ru='Нет данных для печати'"));
		Возврат;
	КонецЕсли;
	
	Если Таб = Неопределено Тогда
		Таб = Новый ТабличныйДокумент;
	КонецЕсли;
	
	Столбик = 2;
	Ряд     = 0;
	
	Макет = ПолучитьМакет("Макет");
	Счетчик = 0;
	Для Каждого СтрТаблицаЯчеек Из Таблица Цикл
		ДобавитьЯчейку(Макет, Таб, СтрТаблицаЯчеек, Столбик, Ряд);
		Счетчик = Счетчик + 1;
	КонецЦикла;
	
	ОбластьСтрока = Макет.ПолучитьОбласть("R1");
	Таб.Вывести(ОбластьСтрока);
	
КонецПроцедуры // Сформировать()

// процедура печати
Процедура Печать(Объект, ТабличныйДокумент, Таблица = Неопределено) Экспорт
	
	Сформировать(Объект, ТабличныйДокумент, Таблица);
	
КонецПроцедуры // Печать()

#КонецОбласти

#КонецЕсли