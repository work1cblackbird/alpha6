
#Область ПрограммныйИнтерфейс

// Процедура обработки команды  "ПараметрыПечати" 
//
// Параметры:
//  МассивСсылок      - Массив			        - Форма, в которой возникло событие.
//  ПараметрыДействия - Структура 				- Набор параметров, использующихся при выполнения операции.
//
Процедура ОбработкаКомандыПечати(МассивСсылок, ПараметрыДействия = Неопределено) Экспорт
	
	Форма = ПараметрыДействия.Форма;
		
	ПараметрыОповещения = Новый Структура("Форма", Форма);
	
	ОткрытьФорму("ОбщаяФорма.ПараметрыПечати", Новый Структура("Ссылка", МассивСсылок[0]), Форма,,,, Новый ОписаниеОповещения("ПослеВызоваФормыПараметрыПечати", ПараметрыПечатиКлиент, ПараметрыОповещения));
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ПослеВызоваФормыПараметрыПечати(РезультатОповещения, ДополнительныеПараметры) Экспорт
	
	Если РезультатОповещения = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Форма = ДополнительныеПараметры.Форма;
	
	ФормаИсточник = Сред(Форма.ИмяФормы, СтрНайти(Форма.ИмяФормы, ".", НаправлениеПоиска.СКонца) + 1);
	
	Если ПараметрыПечатиСервер.ПослеВызоваФормыПараметрыПечатиСервер(РезультатОповещения, ФормаИсточник) Тогда
		// Для формы документа запишем значения в реквизиты формы
		Для каждого РеквизитПечати Из РезультатОповещения.МассивДополнительныхРеквизитов Цикл
			РеквизитыФормы = Форма.
			Свойства_ОписаниеДополнительныхРеквизитов.
			НайтиСтроки(Новый Структура("Свойство", РеквизитПечати.Свойство));
			Если РеквизитыФормы.Количество() > 0 Тогда
				Форма[РеквизитыФормы[0].ИмяРеквизитаЗначение] = РеквизитПечати.Значение;
			КонецЕсли;
		КонецЦикла;
		
		Форма.Модифицированность = Истина;	
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти