// Общий модуль "Технологическая платформа (Вызов сервера)"

#Область СлужебныеПроцедурыИФункции

// Получает текущие значения кода и текста сообщений из макета КодыСообщенийОбОшибках.
//
Функция ПолучитьЗначенияВсехКодовСообщений() Экспорт
	
	// Получим макет предопределенных профилей.
	МакетКодов = ПолучитьОбщийМакет("КодыСообщений");
	КоличествоЗаписейМакета = МакетКодов.ВысотаТаблицы; 
		
	// Получим области-колонки.
	ОбластьКод = МакетКодов.Области.Код;
	ОбластьТекстСообщенияRU = МакетКодов.Области.ТекстСообщенияRU;
	
	// Инициируем временные переменные.
	СписокКодов = Новый Соответствие;
	
	// Обходим макет
	Сч = 1;
	Пока Сч <= КоличествоЗаписейМакета Цикл
		
		// Получим значения ячеек.
		ЯчейкаКод     = СокрЛП(МакетКодов.Область(Сч, ОбластьКод.Лево, Сч, ОбластьКод.Право).Текст);
		ЯчейкаТекстСообщенияRU        = СокрЛП(МакетКодов.Область(Сч, ОбластьТекстСообщенияRU.Лево,Сч, ОбластьТекстСообщенияRU.Право).Текст);
		   
		ТекстСообщения = НСтр("ru = 'Код сообщения:'") + " " + ЯчейкаКод + ". " + НСтр("ru = '"+ЯчейкаТекстСообщенияRU+"'");
		
		// Добавляем в список профилей состав и имя профиля из макета.
		СписокКодов.Вставить(ЯчейкаКод, ТекстСообщения);
		
		Сч = Сч + 1;
	КонецЦикла;
	
	Возврат СписокКодов;

КонецФункции // ПолучитьЗначенияВсехКодовСообщений()

Функция СписокРегистровСОпределеннымИзмерением(Регистры, ТипИзмерения) Экспорт
	
	Результат = Новый Массив;
	
	МетРегистры = Метаданные[Регистры];
	Для Каждого Регистр Из МетРегистры Цикл
		Измерения = Регистр.Измерения;
		Для Каждого Измерение Из Измерения Цикл
			Если Измерение.Тип.СодержитТип(Тип(ТипИзмерения)) Тогда
				Результат.Добавить(Новый Структура("РегистрИмя,ИзмерениеИмя", Регистр.Имя, Измерение.Имя));
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти