
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

// Заменить артикул
//
// Параметры:
//  АртикулДляПоиска      - Строка
//  НовыйАртикулДляПоиска - Строка
//  Артикул               - Строка.
//
Процедура ЗаменитьАртикул(АртикулДляПоиска, НовыйАртикулДляПоиска, Производитель, Артикул) Экспорт
	
	Набор = СоздатьНаборЗаписей();
	Набор.Отбор.АртикулДляПоиска.Установить(АртикулДляПоиска);
	Набор.Отбор.Производитель.Установить(Производитель);
	
	НовыйНабор = СоздатьНаборЗаписей();
	НовыйНабор.Отбор.АртикулДляПоиска.Установить(НовыйАртикулДляПоиска);
	НовыйНабор.Отбор.Производитель.Установить(Производитель);
	
	Набор.Прочитать();
	
	Для Каждого Запись Из Набор Цикл
		НоваяЗапись = НовыйНабор.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяЗапись, Запись);
		
		НоваяЗапись.АртикулДляПоиска = НовыйАртикулДляПоиска;
		НоваяЗапись.Артикул          = Артикул;
	КонецЦикла;
	
	Набор.Очистить();
	Набор.Записать();
	
	НовыйНабор.Записать();
	
	///////////////////////////////////////////////////////////
	Набор = СоздатьНаборЗаписей();
	Набор.Отбор.АртикулЗаменыДляПоиска.Установить(АртикулДляПоиска);
	Набор.Отбор.ПроизводительЗамены.Установить(Производитель);
	
	НовыйНабор = СоздатьНаборЗаписей();
	НовыйНабор.Отбор.АртикулЗаменыДляПоиска.Установить(НовыйАртикулДляПоиска);
	НовыйНабор.Отбор.ПроизводительЗамены.Установить(Производитель);
	
	Набор.Прочитать();
	
	Для Каждого Запись Из Набор Цикл
		НоваяЗапись = НовыйНабор.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяЗапись, Запись);
		
		НоваяЗапись.АртикулЗаменыДляПоиска = НовыйАртикулДляПоиска;
		НоваяЗапись.АртикулЗамены          = Артикул;
	КонецЦикла;
	
	Набор.Очистить();
	Набор.Записать();
	
	НовыйНабор.Записать();
	
КонецПроцедуры

#Область ПараметрыОбработкиРеквизитовОбъекта

Функция ПолучитьОбязательныеРеквизиты(Объект) Экспорт
	
	ОбязательныеРеквизиты = ОбработкаСобытийРегистраСервер.ПолучитьСтандартныеОбязательныеРеквизиты(Объект);
	
	Если НЕ Константы.ПроизводительВНоменклатуреНеОбязательный.Получить() Тогда
		ОбязательныеРеквизиты.Добавить("Производитель");
		ОбязательныеРеквизиты.Добавить("ПроизводительЗамены");
	КонецЕсли;
	
	Возврат ОбязательныеРеквизиты;
	
КонецФункции 

Функция ПолучитьУникальныеРеквизиты(Объект) Экспорт
	
	УникальныеРеквизиты = Новый Структура();
	
	Возврат УникальныеРеквизиты;
	
КонецФункции 

#КонецОбласти

#КонецОбласти

#КонецЕсли