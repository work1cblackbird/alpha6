// Модуль менеджера регистра сведений "Товары в оборудовании"

#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

// Функция возвращает максимальный номер ячейки.
//
// Параметры:
//  ГруппаТоваров - СправочникСсылка - Группа товаров в которой выбирается номер максимальной ячейки.
//
Функция ПолучитьМаксимальныйНомерЯчейки(ГруппаТоваров) Экспорт
	
	НомерЯчейки = 0;
	
	// Формируем текст запроса
	ТекстЗапроса ="
	|ВЫБРАТЬ
	|	МАКСИМУМ(ТоварыВОборудовании.НомерЯчейки) КАК НомерЯчейки
	|ИЗ
	|	РегистрСведений.ТоварыВОборудовании КАК ТоварыВОборудовании
	|ГДЕ
	|	ТоварыВОборудовании.ГруппаТоваров = &ГруппаТоваров";
	
	Запрос = Новый Запрос;
	Запрос.Текст = ТекстЗапроса;
	
	// Устанавливаем параметр запроса
	Запрос.УстановитьПараметр("ГруппаТоваров", ГруппаТоваров);
	Выборка = Запрос.Выполнить().Выбрать();
	
	// Перебираем полученную выборку для определения максимального номера ячейки
	Если Выборка.Следующий() Тогда
		
		НомерЯчейки = Выборка.НомерЯчейки;
		
		Если НЕ ЗначениеЗаполнено(НомерЯчейки) Тогда
			НомерЯчейки = 0;
		КонецЕсли; 
		
	КонецЕсли;
	
	Возврат НомерЯчейки;
	
КонецФункции // ПолучитьМаксимальныйНомерЯчейки()

#Область ПараметрыОбработкиРеквизитовОбъекта

Функция ПолучитьОбязательныеРеквизиты(Объект) Экспорт
	
	ОбязательныеРеквизиты = ОбработкаСобытийРегистраСервер.ПолучитьСтандартныеОбязательныеРеквизиты(Объект);
	
	Возврат ОбязательныеРеквизиты;
	
КонецФункции 

Функция ПолучитьУникальныеРеквизиты(Объект) Экспорт
	
	УникальныеРеквизиты = Новый Структура();
	
	Возврат УникальныеРеквизиты;
	
КонецФункции 

#КонецОбласти

#КонецОбласти

#КонецЕсли