
#Область ОбработчикиСобытий

// Обработчик события нажатия кнопки "Состояние заказов поставщикам" на сервере.
//
// Параметры:
//  ПараметрКоманды - Произвольный - В параметр передается значение от источника, в котором реализована команда
//  ПараметрыВыполненияКоманды - Структура - В обработчике команды можно изменить значение свойств. 
//
&НаСервере
Процедура ОбработкаКомандыНаСервере(ПараметрКоманды, СтруктураПараметров)
	
	// фильтры
	Если ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.ЗаказПокупателя") 
			ИЛИ ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.ЗаказПоставщику") Тогда
		СтруктураПараметров.Отбор.Вставить("Контрагент", ПараметрКоманды.Контрагент);
	ИначеЕсли ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.ЗаказВнутренний") Тогда
		СтруктураПараметров.Отбор.Вставить("Контрагент", ПараметрКоманды.ПодразделениеПолучатель);
	КонецЕсли;
	СтруктураПараметров.Отбор.Вставить("ЗаказПоставщику", ПараметрКоманды);
	
	Отчет = Отчеты.СостояниеЗаказовПоставщикам.Создать();
	МетаданныеОтчета  = Отчет.Метаданные();
	ВариантОтчета     = Отчет.СхемаКомпоновкиДанных.ВариантыНастроек.ДляЗаказа;
	НастройкиВарианта = ВариантОтчета.Настройки;
	НастройкиВарианта.ПараметрыДанных.УстановитьЗначениеПараметра("ВыводитьЗакрытыеЗаказы", Истина);
	СтруктураПараметров.НастройкиВарианта = НастройкиВарианта;
	
КонецПроцедуры // ОбработкаКомандыНаСервере()

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Обработчик события нажатия кнопки "Состояние заказов поставщикам".
//
// Параметры:
//  ПараметрКоманды - Произвольный - В параметр передается значение от источника, в котором реализована команда
//  ПараметрыВыполненияКоманды - ПараметрыВыполненияКоманды - В обработчике команды можно изменить значение свойств
//                                                            параметра Окно и Уникальность.
//
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	// !!!_ Проверить работу отчета
	
	// фильтры
	СтруктураПараметров = Новый Структура;
	СтруктураПараметров.Вставить("Вариант");
	СтруктураПараметров.Вставить("НастройкиВарианта");
	СтруктураПараметров.Вставить("Отбор", Новый Структура);
	
	ОбработкаКомандыНаСервере(ПараметрКоманды, СтруктураПараметров);
	
	ОтчетыПлатформаКлиент.ОткрытьОтчет("Отчет.СостояниеЗаказовПоставщикам", "ДляЗаказа", 
		СтруктураПараметров.НастройкиВарианта,,, СтруктураПараметров.Отбор,, КонецДня(ОбщегоНазначенияКлиент.ДатаСеанса()));
	
КонецПроцедуры // ОбработкаКоманды()

#КонецОбласти