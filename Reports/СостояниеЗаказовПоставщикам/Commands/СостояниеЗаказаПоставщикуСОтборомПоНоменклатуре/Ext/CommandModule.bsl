

#Область ОбработчикиСобытий

// Обработчик события нажатия кнопки "Состояние заказываемых товаров".
//
// Параметры:
//  ПараметрКоманды - Произвольный - В параметр передается значение от источника, в котором реализована команда
//  ПараметрыВыполненияКоманды - ПараметрыВыполненияКоманды - В обработчике команды можно изменить значение свойств
//                                                            параметра Окно и Уникальность.
//
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	// !!!_ Проверить работу отчета
	
	// фильтры
	СтруктураПараметров = Новый Структура;
	СтруктураПараметров.Вставить("НастройкиВарианта");
	СтруктураПараметров.Вставить("Отбор",Новый Структура);
	
	ОбработкаКомандыНаСервере(ПараметрКоманды, СтруктураПараметров);
	
	ОтчетыПлатформаКлиент.ОткрытьОтчет("Отчет.СостояниеЗаказовПоставщикам","СостояниеЗаказываемыхТоваров",СтруктураПараметров.НастройкиВарианта,,, СтруктураПараметров.Отбор,, КонецДня(ОбщегоНазначенияКлиент.ДатаСеанса()));
	
КонецПроцедуры //ОбработкаКоманды()

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Обработчик события нажатия кнопки "Состояние заказываемых товаров" на сервере.
//
// Параметры:
//  ПараметрКоманды - Произвольный - В параметр передается значение от источника, в котором реализована команда
//  ПараметрыВыполненияКоманды - Структура - В обработчике команды можно изменить значение свойств. 
//
&НаСервере
Процедура ОбработкаКомандыНаСервере(ПараметрКоманды, СтруктураПараметров)
	
	МассивНоменклатуры = ПараметрКоманды.Товары.ВыгрузитьКолонку("Номенклатура");
	СписокДляОтбора    = Новый СписокЗначений;
	СписокДляОтбора.ЗагрузитьЗначения(МассивНоменклатуры);
	
	СтруктураПараметров.Отбор.Вставить("Номенклатура",СписокДляОтбора);
	
	Отчет = Отчеты.СостояниеЗаказовПоставщикам.Создать();
	МетаданныеОтчета  = Отчет.Метаданные();
	ВариантОтчета     = Отчет.СхемаКомпоновкиДанных.ВариантыНастроек.СостояниеЗаказываемыхТоваров;
	НастройкиВарианта = ВариантОтчета.Настройки;
	НастройкиВарианта.ПараметрыДанных.УстановитьЗначениеПараметра("ВыводитьЗакрытыеЗаказы", Ложь);
	СтруктураПараметров.НастройкиВарианта = НастройкиВарианта;
	
КонецПроцедуры //ОбработкаКомандыНаСервере()

#КонецОбласти