<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>СчетаФактурыСдокументамиОснованиями</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Разница.РазницаСуммБезНДС</dataPath>
			<field>РазницаСуммБезНДС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма без НДС</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДанныеДокументаПоступления.СуммаБезНДС</dataPath>
			<field>СуммаБезНДС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма без НДС</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=2</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">13</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДанныеДокументаПоступления.СуммаНДС</dataPath>
			<field>СуммаНДС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма НДС</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧДЦ=2</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">10</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Поставщик</dataPath>
			<field>Поставщик</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Поставщик</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СчетФактура</dataPath>
			<field>СчетФактура</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Счет-фактура</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПолеСортировки</dataPath>
			<field>ПолеСортировки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Поле сортировки</v8:content>
				</v8:item>
			</title>
			<valueType>
				<v8:Type>xs:string</v8:Type>
				<v8:StringQualifiers>
					<v8:Length>0</v8:Length>
					<v8:AllowedLength>Variable</v8:AllowedLength>
				</v8:StringQualifiers>
			</valueType>
			<availableValue>
				<value xsi:type="xs:string">АвансовыйОтчет</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Авансовый отчет</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ВозвратОтПокупателя</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Возврат от покупателя</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ВозвратОтПокупателяАвтомобилей</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Возврат от покупателя автомобилей</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">Выписка</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Выписка</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ОтчетКомиссионера</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Отчет комиссионера</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ОтчетКомиссионераЗаАвтомобили</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Отчет комиссионера за автомобили</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ОтчетКомитенту</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Отчет комитенту</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ОтчетКомитентуЗаАвтомобили</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Отчет комитенту за автомобили</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ПоступлениеАвтомобилей</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Поступление автомобилей</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ПоступлениеДопРасходов</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Поступление дополнительных расходов</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">ПоступлениеТоваров</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Поступление товаров</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
			<availableValue>
				<value xsi:type="xs:string">РасходныйКассовыйОрдер</value>
				<presentation xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Расходный кассовый ордер</v8:content>
					</v8:item>
				</presentation>
			</availableValue>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеКомпании</dataPath>
			<field>ПодразделениеКомпании</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДокументПоступления</dataPath>
			<field>ДокументПоступления</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Документ поступления</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>[Данные счета-фактуры].Состояние</dataPath>
			<field>Состояние</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Состояние</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеПоложение</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:HorizontalAlign">Right</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СчетФактура.НомерВходящегоДокументаСФ</dataPath>
			<field>НомерВходящегоДокументаСФ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Счет-фактура.Номер входящего документа СФ</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>[Данные счета-фактуры].СуммаБезНДССФ</dataPath>
			<field>СуммаБезНДССФ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма без НДС</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">13</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>[Данные счета-фактуры].СуммаНДССФ</dataPath>
			<field>СуммаНДССФ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма НДС</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">10</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕстьРазницаВПроведении</dataPath>
			<field>ЕстьРазницаВПроведении</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Есть проблемы в проведении</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕстьРазница</dataPath>
			<field>ЕстьРазница</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Есть проблемы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Разница.РазницаСуммНДС</dataPath>
			<field>РазницаСуммНДС</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма НДС</v8:content>
				</v8:item>
			</title>
			<valueType>
				<v8:Type>xs:decimal</v8:Type>
				<v8:NumberQualifiers>
					<v8:Digits>0</v8:Digits>
					<v8:FractionDigits>0</v8:FractionDigits>
					<v8:AllowedSign>Any</v8:AllowedSign>
				</v8:NumberQualifiers>
			</valueType>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Формат</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>ЧН=Отсутствует</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МинимальнаяШирина</dcscor:parameter>
					<dcscor:value xsi:type="xs:decimal">10</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Разница.РазницаСостояний</dataPath>
			<field>РазницаСостояний</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Состояние</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеПоложение</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:HorizontalAlign">Right</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДанныеДокументаПоступления.СостояниеДокументаПоступления</dataPath>
			<field>СостояниеДокументаПоступления</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Состояние</v8:content>
				</v8:item>
			</title>
			<appearance>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ГоризонтальноеПоложение</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:HorizontalAlign">Right</dcscor:value>
				</dcscor:item>
			</appearance>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДокументПоступления.НомерВходящегоДокумента</dataPath>
			<field>НомерВходящегоДокумента</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Документ поступления.Номер входящего документа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДокументПоступления.ДатаВходящегоДокумента</dataPath>
			<field>ДатаВходящегоДокумента</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Документ поступления.Дата входящего документа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СчетФактура.ДатаВходящегоДокументаСФ</dataPath>
			<field>ДатаВходящегоДокументаСФ</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Счет фактура.Дата входящего документа СФ</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ОбъединенныйЗапрос.Ссылка КАК ДокументПоступления,
	ОбъединенныйЗапрос.ПолеСортировки КАК ПолеСортировки,
	СУММА(ОбъединенныйЗапрос.СуммаНДС) КАК СуммаНДС,
	СУММА(ОбъединенныйЗапрос.СуммаБезНДС) КАК СуммаБезНДС,
	ОбъединенныйЗапрос.Организация КАК Организация,
	ОбъединенныйЗапрос.ПодразделениеКомпании КАК ПодразделениеКомпании,
	ОбъединенныйЗапрос.Поставщик КАК Поставщик,
	ОбъединенныйЗапрос.Состояние КАК Состояние,
	ОбъединенныйЗапрос.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
	ОбъединенныйЗапрос.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента
ПОМЕСТИТЬ ТаблицаДокументов
ИЗ
	(ВЫБРАТЬ
		АвансовыйОтчет.Ссылка КАК Ссылка,
		"АвансовыйОтчет" КАК ПолеСортировки,
		ЕСТЬNULL(АвансовыйОтчетТовары.СуммаНДС, 0) КАК СуммаНДС,
		ЕСТЬNULL(АвансовыйОтчетТовары.СуммаВсего - АвансовыйОтчетТовары.СуммаНДС, 0) КАК СуммаБезНДС,
		АвансовыйОтчет.Организация КАК Организация,
		АвансовыйОтчет.ПодразделениеКомпании КАК ПодразделениеКомпании,
		АвансовыйОтчет.Контрагент КАК Поставщик,
		ВЫБОР
			КОГДА АвансовыйОтчет.Проведен
				ТОГДА "Проведен"
			КОГДА АвансовыйОтчет.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ КАК Состояние,
		"" КАК НомерВходящегоДокумента,
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ДатаВходящегоДокумента
	ИЗ
		Документ.АвансовыйОтчет КАК АвансовыйОтчет
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.АвансовыйОтчет.Товары КАК АвансовыйОтчетТовары
			ПО (АвансовыйОтчетТовары.Ссылка = АвансовыйОтчет.Ссылка)
	ГДЕ
		АвансовыйОтчет.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		АвансовыйОтчет.Ссылка.* КАК ДокументПоступления,
		АвансовыйОтчет.Организация.* КАК Организация,
		АвансовыйОтчет.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		АвансовыйОтчет.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ВозвратОтПокупателя.Ссылка,
		"ВозвратОтПокупателя",
		ЕСТЬNULL(ВозвратОтПокупателяТовары.СуммаНДС, 0),
		ЕСТЬNULL(ВозвратОтПокупателяТовары.СуммаВсего - ВозвратОтПокупателяТовары.СуммаНДС, 0),
		ВозвратОтПокупателя.Организация,
		ВозвратОтПокупателя.ПодразделениеКомпании,
		ВозвратОтПокупателя.Контрагент,
		ВЫБОР
			КОГДА ВозвратОтПокупателя.Проведен
				ТОГДА "Проведен"
			КОГДА ВозвратОтПокупателя.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.ВозвратОтПокупателя КАК ВозвратОтПокупателя
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратОтПокупателя.Товары КАК ВозвратОтПокупателяТовары
			ПО (ВозвратОтПокупателяТовары.Ссылка = ВозвратОтПокупателя.Ссылка)
	ГДЕ
		ВозвратОтПокупателя.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ВозвратОтПокупателя.Ссылка.* КАК ДокументПоступления,
		ВозвратОтПокупателя.Организация.* КАК Организация,
		ВозвратОтПокупателя.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ВозвратОтПокупателя.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ВозвратОтПокупателяАвтомобилей.Ссылка,
		"ВозвратОтПокупателяАвтомобилей",
		ЕСТЬNULL(ВозвратОтПокупателяАвтомобилейАвтомобили.СуммаНДС, 0),
		ЕСТЬNULL(ВозвратОтПокупателяАвтомобилейАвтомобили.СуммаВсего - ВозвратОтПокупателяАвтомобилейАвтомобили.СуммаНДС, 0),
		ВозвратОтПокупателяАвтомобилей.Организация,
		ВозвратОтПокупателяАвтомобилей.ПодразделениеКомпании,
		ВозвратОтПокупателяАвтомобилей.Контрагент,
		ВЫБОР
			КОГДА ВозвратОтПокупателяАвтомобилей.Проведен
				ТОГДА "Проведен"
			КОГДА ВозвратОтПокупателяАвтомобилей.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.ВозвратОтПокупателяАвтомобилей КАК ВозвратОтПокупателяАвтомобилей
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратОтПокупателяАвтомобилей.Автомобили КАК ВозвратОтПокупателяАвтомобилейАвтомобили
			ПО (ВозвратОтПокупателяАвтомобилейАвтомобили.Ссылка = ВозвратОтПокупателяАвтомобилей.Ссылка)
	ГДЕ
		ВозвратОтПокупателяАвтомобилей.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ВозвратОтПокупателяАвтомобилей.Ссылка.* КАК ДокументПоступления,
		ВозвратОтПокупателяАвтомобилей.Организация.* КАК Организация,
		ВозвратОтПокупателяАвтомобилей.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ВозвратОтПокупателяАвтомобилей.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ВозвратОтПокупателяАвтомобилей.Ссылка,
		"ВозвратОтПокупателяАвтомобилей",
		ЕСТЬNULL(ВозвратОтПокупателяАвтомобилейТовары.СуммаНДС, 0),
		ЕСТЬNULL(ВозвратОтПокупателяАвтомобилейТовары.СуммаВсего - ВозвратОтПокупателяАвтомобилейТовары.СуммаНДС, 0),
		ВозвратОтПокупателяАвтомобилей.Организация,
		ВозвратОтПокупателяАвтомобилей.ПодразделениеКомпании,
		ВозвратОтПокупателяАвтомобилей.Контрагент,
		ВЫБОР
			КОГДА ВозвратОтПокупателяАвтомобилей.Проведен
				ТОГДА "Проведен"
			КОГДА ВозвратОтПокупателяАвтомобилей.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.ВозвратОтПокупателяАвтомобилей КАК ВозвратОтПокупателяАвтомобилей
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратОтПокупателяАвтомобилей.Товары КАК ВозвратОтПокупателяАвтомобилейТовары
			ПО (ВозвратОтПокупателяАвтомобилейТовары.Ссылка = ВозвратОтПокупателяАвтомобилей.Ссылка)
	ГДЕ
		ВозвратОтПокупателяАвтомобилей.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ВозвратОтПокупателяАвтомобилей.Ссылка.* КАК ДокументПоступления,
		ВозвратОтПокупателяАвтомобилей.Организация.* КАК Организация,
		ВозвратОтПокупателяАвтомобилей.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ВозвратОтПокупателяАвтомобилей.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		Выписка.Ссылка,
		"Выписка",
		ЕСТЬNULL(ВыпискаСостав.СуммаНДС, 0),
		ВЫБОР
			КОГДА ВыпискаСостав.СуммаРасход &gt; 0
				ТОГДА ЕСТЬNULL(ВыпискаСостав.СуммаРасход - ВыпискаСостав.СуммаНДС, 0)
			ИНАЧЕ ЕСТЬNULL(ВыпискаСостав.СуммаПриход - ВыпискаСостав.СуммаНДС, 0)
		КОНЕЦ,
		Выписка.Организация,
		Выписка.ПодразделениеКомпании,
		Выписка.Контрагент,
		ВЫБОР
			КОГДА Выписка.Проведен
				ТОГДА "Проведен"
			КОГДА Выписка.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		ЕСТЬNULL(ВыпискаСостав.ВхДокНомер, Выписка.ВхДокНомер),
		ЕСТЬNULL(ВыпискаСостав.ВхДокДата, Выписка.ВхДокДата)
	ИЗ
		Документ.Выписка КАК Выписка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.Выписка.Состав КАК ВыпискаСостав
			ПО (ВыпискаСостав.Ссылка = Выписка.Ссылка)
	ГДЕ
		Выписка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		Выписка.Ссылка.* КАК ДокументПоступления,
		Выписка.Организация.* КАК Организация,
		Выписка.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		Выписка.Контрагент.* КАК Поставщик}

	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ОтчетКомиссионера.Ссылка,
		"ОтчетКомиссионера",
		ЕСТЬNULL(ОтчетКомиссионераТовары.СуммаНДС, 0),
		ЕСТЬNULL(ОтчетКомиссионераТовары.СуммаВсего - ОтчетКомиссионераТовары.СуммаНДС, 0),
		ОтчетКомиссионера.Организация,
		ОтчетКомиссионера.ПодразделениеКомпании,
		ОтчетКомиссионера.Контрагент,
		ВЫБОР
			КОГДА ОтчетКомиссионера.Проведен
				ТОГДА "Проведен"
			КОГДА ОтчетКомиссионера.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		ОтчетКомиссионера.ВхДокНомер,
		ОтчетКомиссионера.ВхДокДата
	ИЗ
		Документ.ОтчетКомиссионера КАК ОтчетКомиссионера
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомиссионера.Товары КАК ОтчетКомиссионераТовары
			ПО (ОтчетКомиссионераТовары.Ссылка = ОтчетКомиссионера.Ссылка)
	ГДЕ
		ОтчетКомиссионера.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ОтчетКомиссионера.Ссылка.* КАК ДокументПоступления,
		ОтчетКомиссионера.Организация.* КАК Организация,
		ОтчетКомиссионера.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ОтчетКомиссионера.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ОтчетКомиссионераЗаАвтомобили.Ссылка,
		"ОтчетКомиссионераЗаАвтомобили",
		ЕСТЬNULL(ОтчетКомиссионераЗаАвтомобилиТовары.СуммаНДС, 0),
		ЕСТЬNULL(ОтчетКомиссионераЗаАвтомобилиТовары.СуммаВсего - ОтчетКомиссионераЗаАвтомобилиТовары.СуммаНДС, 0),
		ОтчетКомиссионераЗаАвтомобили.Организация,
		ОтчетКомиссионераЗаАвтомобили.ПодразделениеКомпании,
		ОтчетКомиссионераЗаАвтомобили.Контрагент,
		ВЫБОР
			КОГДА ОтчетКомиссионераЗаАвтомобили.Проведен
				ТОГДА "Проведен"
			КОГДА ОтчетКомиссионераЗаАвтомобили.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		ОтчетКомиссионераЗаАвтомобили.ВхДокНомер,
		ОтчетКомиссионераЗаАвтомобили.ВхДокДата
	ИЗ
		Документ.ОтчетКомиссионераЗаАвтомобили КАК ОтчетКомиссионераЗаАвтомобили
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомиссионераЗаАвтомобили.Товары КАК ОтчетКомиссионераЗаАвтомобилиТовары
			ПО (ОтчетКомиссионераЗаАвтомобилиТовары.Ссылка = ОтчетКомиссионераЗаАвтомобили.Ссылка)
	ГДЕ
		ОтчетКомиссионераЗаАвтомобили.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ОтчетКомиссионераЗаАвтомобили.Ссылка.* КАК ДокументПоступления,
		ОтчетКомиссионераЗаАвтомобили.Организация.* КАК Организация,
		ОтчетКомиссионераЗаАвтомобили.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ОтчетКомиссионераЗаАвтомобили.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ОтчетКомиссионераЗаАвтомобили.Ссылка,
		"ОтчетКомиссионераЗаАвтомобили",
		ЕСТЬNULL(ОтчетКомиссионераЗаАвтомобилиАвтомобили.СуммаНДС, 0),
		ЕСТЬNULL(ОтчетКомиссионераЗаАвтомобилиАвтомобили.СуммаВсего - ОтчетКомиссионераЗаАвтомобилиАвтомобили.СуммаНДС, 0),
		ОтчетКомиссионераЗаАвтомобили.Организация,
		ОтчетКомиссионераЗаАвтомобили.ПодразделениеКомпании,
		ОтчетКомиссионераЗаАвтомобили.Контрагент,
		ВЫБОР
			КОГДА ОтчетКомиссионераЗаАвтомобили.Проведен
				ТОГДА "Проведен"
			КОГДА ОтчетКомиссионераЗаАвтомобили.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		ОтчетКомиссионераЗаАвтомобили.ВхДокНомер,
		ОтчетКомиссионераЗаАвтомобили.ВхДокДата
	ИЗ
		Документ.ОтчетКомиссионераЗаАвтомобили КАК ОтчетКомиссионераЗаАвтомобили
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомиссионераЗаАвтомобили.Автомобили КАК ОтчетКомиссионераЗаАвтомобилиАвтомобили
			ПО (ОтчетКомиссионераЗаАвтомобилиАвтомобили.Ссылка = ОтчетКомиссионераЗаАвтомобили.Ссылка)
	ГДЕ
		ОтчетКомиссионераЗаАвтомобили.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ОтчетКомиссионераЗаАвтомобили.Ссылка.* КАК ДокументПоступления,
		ОтчетКомиссионераЗаАвтомобили.Организация.* КАК Организация,
		ОтчетКомиссионераЗаАвтомобили.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ОтчетКомиссионераЗаАвтомобили.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ОтчетКомитенту.Ссылка,
		"ОтчетКомитенту",
		ЕСТЬNULL(ОтчетКомитентуТовары.СуммаНДС, 0),
		ЕСТЬNULL(ОтчетКомитентуТовары.СуммаВсего - ОтчетКомитентуТовары.СуммаНДС, 0),
		ОтчетКомитенту.Организация,
		ОтчетКомитенту.ПодразделениеКомпании,
		ОтчетКомитенту.Контрагент,
		ВЫБОР
			КОГДА ОтчетКомитенту.Проведен
				ТОГДА "Проведен"
			КОГДА ОтчетКомитенту.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.ОтчетКомитенту КАК ОтчетКомитенту
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомитенту.Товары КАК ОтчетКомитентуТовары
			ПО (ОтчетКомитентуТовары.Ссылка = ОтчетКомитенту.Ссылка)
	ГДЕ
		ОтчетКомитенту.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ОтчетКомитенту.Ссылка.* КАК ДокументПоступления,
		ОтчетКомитенту.Организация.* КАК Организация,
		ОтчетКомитенту.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ОтчетКомитенту.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ОтчетКомитентуЗаАвтомобили.Ссылка,
		"ОтчетКомитентуЗаАвтомобили",
		ЕСТЬNULL(ОтчетКомитентуЗаАвтомобилиАвтомобили.СуммаНДС, 0),
		ЕСТЬNULL(ОтчетКомитентуЗаАвтомобилиАвтомобили.СуммаВсего - ОтчетКомитентуЗаАвтомобилиАвтомобили.СуммаНДС, 0),
		ОтчетКомитентуЗаАвтомобили.Организация,
		ОтчетКомитентуЗаАвтомобили.ПодразделениеКомпании,
		ОтчетКомитентуЗаАвтомобили.Контрагент,
		ВЫБОР
			КОГДА ОтчетКомитентуЗаАвтомобили.Проведен
				ТОГДА "Проведен"
			КОГДА ОтчетКомитентуЗаАвтомобили.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.ОтчетКомитентуЗаАвтомобили КАК ОтчетКомитентуЗаАвтомобили
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомитентуЗаАвтомобили.Автомобили КАК ОтчетКомитентуЗаАвтомобилиАвтомобили
			ПО (ОтчетКомитентуЗаАвтомобилиАвтомобили.Ссылка = ОтчетКомитентуЗаАвтомобили.Ссылка)
	ГДЕ
		ОтчетКомитентуЗаАвтомобили.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ОтчетКомитентуЗаАвтомобили.Ссылка.* КАК ДокументПоступления,
		ОтчетКомитентуЗаАвтомобили.Организация.* КАК Организация,
		ОтчетКомитентуЗаАвтомобили.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ОтчетКомитентуЗаАвтомобили.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПоступлениеАвтомобилей.Ссылка,
		"ПоступлениеАвтомобилей",
		ЕСТЬNULL(ПоступлениеАвтомобилейАвтомобили.СуммаНДС, 0),
		ЕСТЬNULL(ПоступлениеАвтомобилейАвтомобили.СуммаВсего - ПоступлениеАвтомобилейАвтомобили.СуммаНДС, 0),
		ПоступлениеАвтомобилей.Организация,
		ПоступлениеАвтомобилей.ПодразделениеКомпании,
		ПоступлениеАвтомобилей.Контрагент,
		ВЫБОР
			КОГДА ПоступлениеАвтомобилей.Проведен
				ТОГДА "Проведен"
			КОГДА ПоступлениеАвтомобилей.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.ПоступлениеАвтомобилей КАК ПоступлениеАвтомобилей
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеАвтомобилей.Автомобили КАК ПоступлениеАвтомобилейАвтомобили
			ПО (ПоступлениеАвтомобилейАвтомобили.Ссылка = ПоступлениеАвтомобилей.Ссылка)
	ГДЕ
		ПоступлениеАвтомобилей.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ПоступлениеАвтомобилей.Ссылка.* КАК ДокументПоступления,
		ПоступлениеАвтомобилей.Организация.* КАК Организация,
		ПоступлениеАвтомобилей.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ПоступлениеАвтомобилей.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПоступлениеДопРасходов.Ссылка,
		"ПоступлениеДопРасходов",
		ЕСТЬNULL(ПоступлениеДопРасходовТовары.СуммаНДС, 0),
		ЕСТЬNULL(ПоступлениеДопРасходовТовары.СуммаВсего - ПоступлениеДопРасходовТовары.СуммаНДС, 0),
		ПоступлениеДопРасходов.Организация,
		ПоступлениеДопРасходов.ПодразделениеКомпании,
		ПоступлениеДопРасходов.Контрагент,
		ВЫБОР
			КОГДА ПоступлениеДопРасходов.Проведен
				ТОГДА "Проведен"
			КОГДА ПоступлениеДопРасходов.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		ПоступлениеДопРасходов.ВхДокНомер,
		ПоступлениеДопРасходов.ВхДокДата
	ИЗ
		Документ.ПоступлениеДопРасходов КАК ПоступлениеДопРасходов
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеДопРасходов.Товары КАК ПоступлениеДопРасходовТовары
			ПО (ПоступлениеДопРасходовТовары.Ссылка = ПоступлениеДопРасходов.Ссылка)
	ГДЕ
		ПоступлениеДопРасходов.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ПоступлениеДопРасходов.Ссылка.* КАК ДокументПоступления,
		ПоступлениеДопРасходов.Организация.* КАК Организация,
		ПоступлениеДопРасходов.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ПоступлениеДопРасходов.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПоступлениеТоваров.Ссылка,
		"ПоступлениеТоваров",
		ЕСТЬNULL(ПоступлениеТоваровТовары.СуммаНДС, 0),
		ЕСТЬNULL(ПоступлениеТоваровТовары.СуммаВсего - ПоступлениеТоваровТовары.СуммаНДС, 0),
		ПоступлениеТоваров.Организация,
		ПоступлениеТоваров.ПодразделениеКомпании,
		ПоступлениеТоваров.Контрагент,
		ВЫБОР
			КОГДА ПоступлениеТоваров.Проведен
				ТОГДА "Проведен"
			КОГДА ПоступлениеТоваров.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		ПоступлениеТоваров.ВхДокНомер,
		ПоступлениеТоваров.ВхДокДата
	ИЗ
		Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
			ПО (ПоступлениеТоваровТовары.Ссылка = ПоступлениеТоваров.Ссылка)
	ГДЕ
		ПоступлениеТоваров.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		ПоступлениеТоваров.Ссылка.* КАК ДокументПоступления,
		ПоступлениеТоваров.Организация.* КАК Организация,
		ПоступлениеТоваров.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		ПоступлениеТоваров.Контрагент.* КАК Поставщик}
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		РасходныйКассовыйОрдер.Ссылка,
		"РасходныйКассовыйОрдер",
		ЕСТЬNULL(РасходныйКассовыйОрдер.СуммаНДС, 0),
		ЕСТЬNULL(РасходныйКассовыйОрдер.СуммаДокумента - РасходныйКассовыйОрдер.СуммаНДС, 0),
		РасходныйКассовыйОрдер.Организация,
		РасходныйКассовыйОрдер.ПодразделениеКомпании,
		РасходныйКассовыйОрдер.Контрагент,
		ВЫБОР
			КОГДА РасходныйКассовыйОрдер.Проведен
				ТОГДА "Проведен"
			КОГДА РасходныйКассовыйОрдер.ПометкаУдаления
				ТОГДА "Удален"
			ИНАЧЕ "Записан"
		КОНЕЦ,
		"",
		ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	ИЗ
		Документ.РасходныйКассовыйОрдер КАК РасходныйКассовыйОрдер
	ГДЕ
		РасходныйКассовыйОрдер.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	{ГДЕ
		РасходныйКассовыйОрдер.Ссылка.* КАК ДокументПоступления,
		РасходныйКассовыйОрдер.Организация.* КАК Организация,
		РасходныйКассовыйОрдер.ПодразделениеКомпании.* КАК ПодразделениеКомпании,
		РасходныйКассовыйОрдер.Контрагент.* КАК Поставщик}) КАК ОбъединенныйЗапрос
	
СГРУППИРОВАТЬ ПО
	ОбъединенныйЗапрос.Ссылка,
	ОбъединенныйЗапрос.ПолеСортировки,
	ОбъединенныйЗапрос.Организация,
	ОбъединенныйЗапрос.ПодразделениеКомпании,
	ОбъединенныйЗапрос.Поставщик,
	ОбъединенныйЗапрос.Состояние,
	ОбъединенныйЗапрос.НомерВходящегоДокумента,
	ОбъединенныйЗапрос.ДатаВходящегоДокумента

ИМЕЮЩИЕ
	СУММА(ОбъединенныйЗапрос.СуммаНДС) + СУММА(ОбъединенныйЗапрос.СуммаБезНДС) &lt;&gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СчетФактураПолученный.Ссылка КАК СчетФактура,
	СчетФактураПолученный.ДокументОснование КАК ДокументОснование,
	СчетФактураПолученный.Организация КАК Организация,
	СчетФактураПолученный.ПодразделениеКомпании КАК ПодразделениеКомпании,
	СчетФактураПолученный.Контрагент КАК Поставщик,
	СчетФактураПолученный.СуммаДокумента - СчетФактураПолученный.СуммаНДСДокумента КАК СуммаБезНДС,
	СчетФактураПолученный.СуммаНДСДокумента КАК СуммаНДС,
	ВЫБОР
		КОГДА СчетФактураПолученный.Проведен
			ТОГДА "Проведен"
		КОГДА СчетФактураПолученный.ПометкаУдаления
			ТОГДА "Удален"
		ИНАЧЕ "Записан"
	КОНЕЦ КАК Состояние,
	СчетФактураПолученный.ВхДокНомер КАК НомерВходящегоДокумента,
	СчетФактураПолученный.ВхДокДата КАК ДатаВходящегоДокумента
ПОМЕСТИТЬ СчетаФактуры
ИЗ
	Документ.СчетФактураПолученный КАК СчетФактураПолученный
ГДЕ
	СчетФактураПолученный.ДокументОснование В
			(ВЫБРАТЬ
				ТаблицаДокументов.ДокументПоступления КАК ДокументПоступления
			ИЗ
				ТаблицаДокументов КАК ТаблицаДокументов)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаДокументов.ДокументПоступления КАК ДокументПоступления,
	ТаблицаДокументов.ПолеСортировки КАК ПолеСортировки,
	ТаблицаДокументов.Состояние КАК СостояниеДокументаПоступления,
	СчетаФактуры.СчетФактура КАК СчетФактура,
	ЕСТЬNULL(СчетаФактуры.Состояние, "Не создан") КАК Состояние,
	ТаблицаДокументов.СуммаБезНДС КАК СуммаБезНДС,
	ТаблицаДокументов.СуммаНДС КАК СуммаНДС,
	ЕСТЬNULL(СчетаФактуры.СуммаБезНДС, 0) КАК СуммаБезНДССФ,
	ЕСТЬNULL(СчетаФактуры.СуммаНДС, 0) КАК СуммаНДССФ,
	ТаблицаДокументов.СуммаБезНДС - ЕСТЬNULL(СчетаФактуры.СуммаБезНДС, 0) КАК РазницаСуммБезНДС,
	ТаблицаДокументов.СуммаНДС - ЕСТЬNULL(СчетаФактуры.СуммаНДС, 0) КАК РазницаСуммНДС,
	ВЫБОР
		КОГДА ТаблицаДокументов.Состояние = СчетаФактуры.Состояние
			ТОГДА "Отсутствует"
		ИНАЧЕ ТаблицаДокументов.Состояние + " - " + СчетаФактуры.Состояние
	КОНЕЦ КАК РазницаСостояний,
	ТаблицаДокументов.СуммаНДС + ТаблицаДокументов.СуммаБезНДС &lt;&gt; ЕСТЬNULL(СчетаФактуры.СуммаНДС, 0) + ЕСТЬNULL(СчетаФактуры.СуммаБезНДС, 0)
		ИЛИ ТаблицаДокументов.Состояние &lt;&gt; СчетаФактуры.Состояние КАК ЕстьРазница,
	ТаблицаДокументов.Состояние &lt;&gt; СчетаФактуры.Состояние КАК ЕстьРазницаВПроведении,
	ТаблицаДокументов.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
	ТаблицаДокументов.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
	СчетаФактуры.НомерВходящегоДокумента КАК НомерВходящегоДокументаСФ,
	СчетаФактуры.ДатаВходящегоДокумента КАК ДатаВходящегоДокументаСФ
{ВЫБРАТЬ
	ДокументПоступления,
	СчетФактура,
	Состояние,
	СуммаБезНДС,
	СуммаНДС,
	СуммаБезНДССФ,
	СуммаНДССФ,
	ЕстьРазница,
	ЕстьРазницаВПроведении,
	РазницаСуммБезНДС,
	РазницаСуммНДС,
	РазницаСостояний,
	ПолеСортировки,
	СостояниеДокументаПоступления,
	НомерВходящегоДокумента КАК НомерВходящегоДокумента,
	ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
	НомерВходящегоДокументаСФ КАК НомерВходящегоДокументаСФ,
	ДатаВходящегоДокументаСФ КАК ДатаВходящегоДокументаСФ}
ИЗ
	ТаблицаДокументов КАК ТаблицаДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ СчетаФактуры КАК СчетаФактуры
		ПО ТаблицаДокументов.ДокументПоступления = СчетаФактуры.ДокументОснование
{ГДЕ
	(ТаблицаДокументов.СуммаНДС + ТаблицаДокументов.СуммаБезНДС &lt;&gt; ЕСТЬNULL(СчетаФактуры.СуммаНДС, 0) + ЕСТЬNULL(СчетаФактуры.СуммаБезНДС, 0)
			ИЛИ ТаблицаДокументов.Состояние &lt;&gt; СчетаФактуры.Состояние) КАК ЕстьРазница,
	(ТаблицаДокументов.Состояние &lt;&gt; СчетаФактуры.Состояние) КАК ЕстьРазницаВПроведении}

УПОРЯДОЧИТЬ ПО
	ПолеСортировки</query>
		<autoFillFields>false</autoFillFields>
	</dataSet>
	<totalField>
		<dataPath>Разница.РазницаСуммБезНДС</dataPath>
		<expression>Сумма(Разница.РазницаСуммБезНДС)</expression>
	</totalField>
	<totalField>
		<dataPath>Разница.РазницаСуммНДС</dataPath>
		<expression>Сумма(Разница.РазницаСуммНДС)</expression>
	</totalField>
	<totalField>
		<dataPath>ДанныеДокументаПоступления.СуммаБезНДС</dataPath>
		<expression>Сумма(ДанныеДокументаПоступления.СуммаБезНДС)</expression>
	</totalField>
	<totalField>
		<dataPath>[Данные счета-фактуры].СуммаБезНДССФ</dataPath>
		<expression>Сумма([Данные счета-фактуры].СуммаБезНДССФ)</expression>
	</totalField>
	<totalField>
		<dataPath>ДанныеДокументаПоступления.СуммаНДС</dataPath>
		<expression>Сумма(ДанныеДокументаПоступления.СуммаНДС)</expression>
	</totalField>
	<totalField>
		<dataPath>[Данные счета-фактуры].СуммаНДССФ</dataPath>
		<expression>Сумма([Данные счета-фактуры].СуммаНДССФ)</expression>
	</totalField>
	<totalField>
		<dataPath>[Данные счета-фактуры].Состояние</dataPath>
		<expression>Максимум([Данные счета-фактуры].Состояние)</expression>
	</totalField>
	<totalField>
		<dataPath>ДанныеДокументаПоступления.СостояниеДокументаПоступления</dataPath>
		<expression>Максимум(ДанныеДокументаПоступления.СостояниеДокументаПоступления)</expression>
	</totalField>
	<totalField>
		<dataPath>ЕстьРазница</dataPath>
		<expression>Максимум(ЕстьРазница)</expression>
	</totalField>
	<totalField>
		<dataPath>Разница.РазницаСостояний</dataPath>
		<expression>Максимум(Разница.РазницаСостояний)</expression>
	</totalField>
	<totalField>
		<dataPath>ЕстьРазницаВПроведении</dataPath>
		<expression>Максимум(ЕстьРазницаВПроведении)</expression>
	</totalField>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Отчет по полученным счетам-фактурам</v8:content>
			</v8:item>
		</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemFolder">
					<dcsset:field>ДанныеДокументаПоступления</dcsset:field>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ДанныеДокументаПоступления.СостояниеДокументаПоступления</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ДанныеДокументаПоступления.СуммаБезНДС</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>ДанныеДокументаПоступления.СуммаНДС</dcsset:field>
					</dcsset:item>
					<dcsset:placement>Auto</dcsset:placement>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemFolder">
					<dcsset:field>[Данные счета-фактуры]</dcsset:field>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>[Данные счета-фактуры].Состояние</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>[Данные счета-фактуры].СуммаБезНДССФ</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>[Данные счета-фактуры].СуммаНДССФ</dcsset:field>
					</dcsset:item>
					<dcsset:placement>Auto</dcsset:placement>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemFolder">
					<dcsset:field>Разница</dcsset:field>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Разница.РазницаСостояний</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Разница.РазницаСуммБезНДС</dcsset:field>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:SelectedItemField">
						<dcsset:field>Разница.РазницаСуммНДС</dcsset:field>
					</dcsset:item>
					<dcsset:placement>Auto</dcsset:placement>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:filter>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Организация</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">ПодразделениеКомпании</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Поставщик</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
				</dcsset:item>
			</dcsset:filter>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>НачалоПериода</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardBeginningDate">
						<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
						<v8:date>0001-01-01T00:00:00</v8:date>
					</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>КонецПериода</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardBeginningDate">
						<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
						<v8:date>0001-01-01T00:00:00</v8:date>
					</dcscor:value>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:conditionalAppearance>
				<dcsset:item>
					<dcsset:selection>
						<dcsset:item>
							<dcsset:field>Разница.РазницаСуммБезНДС</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">Разница.РазницаСуммБезНДС</dcsset:left>
							<dcsset:comparisonType>NotEqual</dcsset:comparisonType>
							<dcsset:right xsi:type="xs:decimal">0</dcsset:right>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>ЦветТекста</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
					<dcsset:presentation xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Проблемы сумм без НДС</v8:content>
						</v8:item>
					</dcsset:presentation>
					<dcsset:useInFieldsHeader>DontUse</dcsset:useInFieldsHeader>
					<dcsset:useInHeader>DontUse</dcsset:useInHeader>
					<dcsset:useInParameters>DontUse</dcsset:useInParameters>
					<dcsset:useInFilter>DontUse</dcsset:useInFilter>
				</dcsset:item>
				<dcsset:item>
					<dcsset:selection>
						<dcsset:item>
							<dcsset:field>Разница.РазницаСуммНДС</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">Разница.РазницаСуммНДС</dcsset:left>
							<dcsset:comparisonType>NotEqual</dcsset:comparisonType>
							<dcsset:right xsi:type="xs:decimal">0</dcsset:right>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>ЦветТекста</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
						</dcscor:item>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:use>false</dcscor:use>
							<dcscor:parameter>Формат</dcscor:parameter>
							<dcscor:value xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>ЧЦ=12; ЧДЦ=; ЧН=0,00</v8:content>
								</v8:item>
							</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
					<dcsset:presentation xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Проблемы сумм НДС</v8:content>
						</v8:item>
					</dcsset:presentation>
					<dcsset:useInFieldsHeader>DontUse</dcsset:useInFieldsHeader>
					<dcsset:useInHeader>DontUse</dcsset:useInHeader>
					<dcsset:useInParameters>DontUse</dcsset:useInParameters>
					<dcsset:useInFilter>DontUse</dcsset:useInFilter>
				</dcsset:item>
				<dcsset:item>
					<dcsset:selection>
						<dcsset:item>
							<dcsset:field>Разница.РазницаСостояний</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">ДанныеДокументаПоступления.СостояниеДокументаПоступления</dcsset:left>
							<dcsset:comparisonType>NotEqual</dcsset:comparisonType>
							<dcsset:right xsi:type="dcscor:Field">[Данные счета-фактуры].Состояние</dcsset:right>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>ЦветТекста</dcscor:parameter>
							<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
					<dcsset:presentation xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Проблемы состояний документов</v8:content>
						</v8:item>
					</dcsset:presentation>
					<dcsset:useInFieldsHeader>DontUse</dcsset:useInFieldsHeader>
					<dcsset:useInHeader>DontUse</dcsset:useInHeader>
					<dcsset:useInParameters>DontUse</dcsset:useInParameters>
					<dcsset:useInFilter>DontUse</dcsset:useInFilter>
				</dcsset:item>
			</dcsset:conditionalAppearance>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ВертикальноеРасположениеОбщихИтогов</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Заголовок</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType"/>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemGroup">
				<dcsset:groupItems>
					<dcsset:item xsi:type="dcsset:GroupItemField">
						<dcsset:field>ДокументПоступления</dcsset:field>
						<dcsset:groupType>Items</dcsset:groupType>
						<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
						<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
						<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:GroupItemField">
						<dcsset:field>СчетФактура</dcsset:field>
						<dcsset:groupType>Items</dcsset:groupType>
						<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
						<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
						<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
					</dcsset:item>
				</dcsset:groupItems>
				<dcsset:order>
					<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
				</dcsset:order>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
				</dcsset:selection>
				<dcsset:outputParameters>
					<dcscor:item xsi:type="dcsset:SettingsParameterValue">
						<dcscor:use>false</dcscor:use>
						<dcscor:parameter>РасположениеИтогов</dcscor:parameter>
						<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">End</dcscor:value>
					</dcscor:item>
				</dcsset:outputParameters>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>